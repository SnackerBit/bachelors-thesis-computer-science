We will consider a system S linearly coupled to a bath B of harmonic oscillators. 
We can split the Hamiltonian of such a model into a system, bath and interaction part
\begin{equation*}
    \hat{H} = \hat{H}_\text{S} \otimes \mathbb{1}_\text{B} + \mathbb{1}_\text{S} \otimes \hat{H}_\text{B}
    + \hat{H}_\text{int}.
\end{equation*}
We assume that the system lives on $N$ sites, and each site couples independently to $M$
harmonic oscillators. The bath Hamiltonian is then given by
\begin{equation*}
    \hat{H}_\text{B} = \sum_{i=1}^{N}\sum_{\lambda=1}^{M}\nu_{i, \lambda} 
    \hat{a}^\dagger_{i, \lambda} \hat{a}_{i, \lambda},
\end{equation*}
where $\hat{a}^\dagger_{n,\lambda}$, $\hat{a}_{n,\lambda}$ are the bosonic creation and annihilation
operators of the $\lambda$th harmonic oscillator coupling to site $n$, and $\nu_{n,\lambda}$ 
are constants. The interaction Hamiltonian can be written as
\begin{equation*}
    \hat{H}_\text{int} = \sum_{i=1}^{N}\sum_{\lambda=1}^{M} \left( \gamma_{i,\lambda}^*
    L_i \otimes \hat{a}_{i,\lambda}^\dagger + \text{h.c.} \right)
\end{equation*}
with constants $\gamma_{n,\lambda}$. The system operators $\hat{L}_n$ describe the coupling
of the system to the bath modes.
\\
In the context of open systems it is useful to 
define the \textit{bath correlation function}
\begin{equation*}
    \alpha(\tau) = \frac{1}{\pi} \int_0^\infty \text{d}\omega S(\omega) 
    \left[\coth\left(\frac{\omega}{2T}\right)\cos\left(\omega\tau\right)-i\sin\left(\tau\right)\right]
\end{equation*}
with the \textit{spectral density} $S\left(\omega\right)$. The bath correlation function fully
characterizes the influence of the environment at temperature T \cite{Gao:2022}.
\\
We are interested in the dynamics of the system S, which can be described in terms of the reduced
density matrix
\begin{equation*}
    \rho\left(t\right) = \trace_\text{B}\left\{\rho_\text{tot}\left(t\right)\right\},
\end{equation*}
where $\rho_\text{tot}\left(t\right)$ is the density matrix of the total system at time $t$.
$\trace_\text{B}\left\{\cdots\right\}$ denotes the trace over all bath degrees of freedom.
We assume that the total system is initially in the state
\begin{equation*}
    \rho_\text{tot}\left(0\right) = \rho_\text{S}\left(0\right) \otimes \rho_\text{B, therm},
\end{equation*}
where the bath is in the thermal state
\begin{equation*}
    \rho_\text{therm}^{B} = \frac{e^{-\hat{H}_\text{B} / T}}{Z_\text{B}}
\end{equation*}
with the partition function $Z_\text{B} = \trace_\text{B}\left\{e^{-\hat{H}_\text{B} / T}\right\}$
\\
In terms of Non-Markovian Quantum State Diffusion (NMQSD), one obtains the reduced density matrix
$\rho\left(t\right)$ from an average over pure states
\begin{equation}
    \label{eq:averaging_states_linear}
    \rho\left(t\right) = \mathbb{E}\left[\ket*{\Psi_t\left(z^*\right)}\bra*{\Psi_t\left(z^*)\right)}\right].
\end{equation}
The pure states $\bra*{\Psi_t\left(z^*\right)} \in \mathcal{H}_\text{S}$ are vectors in the system
Hilbert space, that depend on a family of stochastic processes $z^*\coloneqq\left\{z^*_n\left(t\right)\right\}$.
The expectation value $\mathbb{E}\left[\cdots\right]$ can then be computed by taking the
average over different realizations of $z^*$. For NMQSD, all stochastic processes $z_n^*\left(t\right)$ must
have the following properties:
\begin{subequations}
    \label{eq:optim}
    \begin{align}
            & \mathbb{E}\left[z_{i,t}\right]=\mathbb{E}\left[z_{i,t}\right]=0 \label{eq:cost},\\
            & \mathbb{E}\left[z_{i,t}z_{i,t}\right]=0, \label{eq:const1}\\
            & \mathbb{E}\left[z_{i,t}z_{i,t}^*\right]=\alpha\left(t-s\right). \label{eq:const2}
    \end{align}
\end{subequations}
Each pure state $\ket*{\Psi_t\left(z^*\right)}$ starts off in the same initial state
$\ket*{\Psi_{t=0}\left(z^*\right)}=\ket*{\Psi_0}$ and then evolves according
to the Non-Markovian Quantum State Diffusion (NMQSD) equation \cite{Diosi:1997,Diosi:1998}
\begin{equation}
    \label{eq:non_markovian_schroedinger_equation}
    \frac{\partial}{\partial t} \ket*{\Psi_t} = -iH_\text{S} \ket*{\Psi_t}
    + \sum_{i=1}^{N} \left( L_i z_{i,t}^* \ket*{\Psi_t}
    - L_i^\dagger \int_0^t \text{ds} \alpha\left(t-s\right) 
    \frac{\delta \ket*{\Psi_t}}{\delta z_{n,s}^*} \right),
\end{equation}
where we omitted the explicit dependency of $\ket*{\Psi_t}$ on $z^*$ due to brevity.